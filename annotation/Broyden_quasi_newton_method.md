# **非线性方程组求解策略：Broyden拟牛顿法**

### 1. 问题建模背景

TESPy组件约束可表述为非线性方程组：  

$$F(x) = 0$$

$$x ∈ ℝⁿ  (n为系统自由度)$$

其中每个方程对应：

- 质量守恒方程
- 能量守恒方程
- 自定义约束：各个设备的物理过程约束

### 2. 传统牛顿法的局限

经典牛顿迭代公式：

$$x_{k+1} = x_k - J⁻¹(x_k)F(x_k)$$

- 需要显式计算Jacobian矩阵 **J** = ∂F/∂x  
- 每次迭代O(n³)计算复杂度  
- 热力系统n常达100+量级，直接计算不现实

### 3. Broyden方法创新点

**核心思想**：用低秩更新逼近Jacobian，避免重复计算

**迭代步骤**：

while $||F(x_k)|| > ε$:

1. 计算步长：$$s_k = -B_k⁻¹ F(x_k)$$

2. 更新解：$$x_{k+1} = x_k + s_k$$

3. 计算残差变化：$$y_k = F(x_{k+1}) - F(x_k)$$

4. 更新Jacobian近似：$$B_{k+1} = B_k + \frac{(y_k - B_k s_k)s_kᵀ} {||s_k||²}$$
